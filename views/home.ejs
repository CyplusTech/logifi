<!DOCTYPE html>
<html lang="en">
<head>
    <%- include("partials/head")%>
</head>
<body>

  <!-- Navbar -->
    <%- include("partials/navBar")%>

  <!-- Hero -->
<!-- views/home.ejs -->
<section class="hero">
  <div class="hero-content">
    <h2>Find Comfort. Live Better.</h2>
    <p>
      Find secure, affordable housing near Oko Polytechnic ‚Äî
      fully verified listings for stress-free living.
    </p>

    <form action="/lodges" method="get" class="hero-search-bar">
      <input 
        type="text" 
        name="search" 
        placeholder="Search by name, price, or location..." 
        required
      />
      <button type="submit"><i class="fas fa-search"></i></button>
    </form>
  </div>
</section>


<section class="about" id="about">
  <div class="about-container">
    <div class="about-text" data-animate="fade-left">
      <h2>About Logifi</h2>
      <p id="aboutText">
        Logifi is a platform built to make finding and managing lodges simple and stress-free.  
        Whether you are a landlord wanting to share available rooms, an agent helping clients find the right place,  
        or someone looking for a safe and convenient lodge to stay in, Logifi brings everyone together in one place.  
        <span id="dots">...</span>
        <span id="more" style="display: none;">
          Landlords and agents can list their lodges with all the important details, so potential tenants can  
          easily see what is available and make an informed choice. Tenants can browse lodges, check photos,  
          read descriptions, and quickly contact the owner or agent for more information.  

          Our platform focuses on clear communication and smooth connections, helping everyone save time  
          and avoid confusion. With Lodgify, finding or renting a lodge becomes a simple, safe, and  
          enjoyable experience for everyone involved.
        </span>
      </p>
      <button onclick="toggleReadMore()" id="readMoreBtn" class="read-more-btn">Read More</button>
    </div>
    <div class="about-img" data-animate="fade-right">
      <img src="images/about_image.webp" alt="Logifi About" width="100%" height="100%">
    </div>
  </div>
</section>


  <!-- ///// Unique Lodge Listing Section ///// -->
<% if (lodges && lodges.length > 0) { %>
  <!-- ///// Unique Lodge Listing Section ///// -->
  <section class="home-lodge-showcase">
    <div class="home-lodge-header">
      <h2>Top Lodge Listings Near You</h2>
      <p>Explore top available lodges close to your campus.</p>
    </div>

    <div class="home-lodge-grid">
      <% lodges.forEach(lodge => { %>
        <!-- Lodge Card Start -->
        <a href="/lodges/single/<%= lodge._id %>" class="home-lodge-card unique-lodge-card">


       <div class="home-lodge-img">
          <% if (lodge.media && lodge.media.length > 0) { %>
            <% if (lodge.media[0].type === 'video') { %>
              <video controls preload="metadata" playsinline>
                <source src="<%= lodge.media[0].url %>" type="video/mp4">
                Your browser does not support the video tag.
              </video>
            <% } else { %>
              <img src="<%= lodge.media[0].url %>" alt="<%= lodge.title %>" />
            <% } %>
          <% } else { %>
            <img src="/images/about_image.webp" alt="<%= lodge.title %>" />
          <% } %>

          <span class="lodge-status <%= lodge.status === 'available' ? 'available' : 'occupied' %>">
            <%= lodge.status %>
          </span>
        </div>




          <div class="plx-agent-box">
            <span class="plx-agent-name"><%= lodge.agent?.name %></span>

            <% if (lodge.agent && lodge.agent.kycCompleted) { %>
              <span class="shield-verified" title="Verified agent">
                <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="#0b8a55" d="M12 1 3 4v6c0 5 3.7 9.7 9 11 5.3-1.3 9-6 9-11V4l-9-3z"/>
                  <path fill="#fff" d="M10 13.5l-1.6-1.6 1-1 1.6 1.6L15.6 8l1 1-6.6 4.5z"/>
                </svg>
              </span>
            <% } %>
          </div>


          <div class="home-lodge-info">
            <h3><%=lodge.title %></h3>
            <p class="lodge-location">üìç <%= lodge.location %></p>
          </div>
        </a>
      <% }) %>
    </div>

    <div class="home-lodge-viewmore">
      <a href="/lodges#lodge-section" class="view-lodges-btn" 
   onclick="trackClick('view_more_lodges')">View More Listings</a>
    </div>
  </section>
<% } %>


  <section class="how-it-works" id="how-it-works">
  <div class="how-header">
     <h2 style="font-size: 32px; margin-bottom: 20px;">How It Works</h2>
  <p style="font-size: 16px; color: #666; max-width: 600px; margin: 0 auto 40px;">
    Find your perfect lodge in just a few steps ‚Äî verified, stress-free, and reliable.
  </p>
  </div>
  <div class="steps-container">
    <div class="step">
      <div class="icon">&#128269;</div>
      <h3>Search Lodge</h3>
      <p>Enter location like ‚ÄúMain Gate‚Äù or price.</p>
    </div>
    <div class="step">
      <div class="icon">&#128205;</div>
      <h3>View Listings</h3>
      <p>Explore detailed lodge listings with images, prices, and location.</p>
    </div>
    <div class="step">
      <div class="icon">&#128222;</div>
      <h3>Contact Owner</h3>
      <p>Connect directly via WhatsApp..</p>
    </div>
  </div>
</section>

<!-- ///warning alert///// -->
<div style="background-color: #f8d7da; color: #856404; border: 1px solid #ffeeba; padding: 16px; border-radius: 8px; margin: 20px auto; font-size: 15px; max-width: 95%; box-sizing: border-box; text-align: left;">
  ‚ö†Ô∏è <strong>Important:</strong> Please do <strong>not make any payment</strong> until you have physically inspected the lodge and you're fully satisfied with the location, condition, and agreement.
  <br><br>
  Logifi will never ask you to pay on behalf of a lodge owner. Be vigilant and avoid scammers.
</div>


<!-- /////contact us///// -->
<section id="contact" class="reveal">
  <div class="contact-container">
    <h2>Contact Us</h2>
    <p>If you have questions or want to partner with Logifi, fill out the form below or reach us directly.</p>

    <form class="contact-form" id="contactForm">
      <input type="text" name="name" placeholder="Your Full Name" required />
      <input type="email" name="email" placeholder="Your Email Address" required />
      <textarea name="message" placeholder="Your Message" rows="5" required></textarea>
      <button type="submit">Send Message</button>
    </form>
    <div id="contactMessage" style="display:none; color:green; margin-top:10px;">
  ‚úÖ Your message has been sent! You can reply via WhatsApp.
</div>
  </div>
</section>



<!-- ////// Footer ////// -->
    <!-- <%- include("partials/footer")%> -->
    <%- include("partials/footer")%>


  <!-- JavaScript -->
<script>
//////about section script
  function toggleReadMore() {
  const dots = document.getElementById("dots");
  const moreText = document.getElementById("more");
  const btnText = document.getElementById("readMoreBtn");

  if (dots.style.display === "none") {
    dots.style.display = "inline";
    btnText.innerText = "Read More";
    moreText.style.display = "none";
  } else {
    dots.style.display = "none";
    btnText.innerText = "Read Less";
    moreText.style.display = "inline";
  }
}

  document.addEventListener("DOMContentLoaded", function () {
    // Animate all data-animate elements
    const elements = document.querySelectorAll("[data-animate]");

    const sectionObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("in-view");
        } else {
          entry.target.classList.remove("in-view");
        }
      });
    }, {
      threshold: 0.3
    });

    elements.forEach(el => sectionObserver.observe(el));

    // Animate each .step element
    const steps = document.querySelectorAll('.step');

    const stepObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate');
        } else {
          entry.target.classList.remove('animate');
        }
      });
    }, {
      threshold: 0.3
    });

    steps.forEach(step => stepObserver.observe(step));
  });

  // Reveal on scroll animation
  window.addEventListener('scroll', () => {
    const reveals = document.querySelectorAll('.reveal');
    reveals.forEach(el => {
      const top = el.getBoundingClientRect().top;
      const windowHeight = window.innerHeight;
      if (top < windowHeight - 100) {
        el.classList.add('active');
      } else {
        el.classList.remove('active'); // allows re-animation
      }
    });
  });

const contactForm = document.getElementById("contactForm");
const contactMessage = document.getElementById("contactMessage");

contactForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  const formData = new FormData(contactForm);
  const data = {
    name: formData.get("name"),
    email: formData.get("email"),
    message: formData.get("message")
  };

  try {
    const res = await fetch("/contact/send", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    const result = await res.json();

    if (result.success) {
      // Show confirmation
      contactMessage.style.display = "block";
      contactMessage.innerText = "Message sent successfully!";

      // Reset form
      contactForm.reset();

        // Hide message after 1 minute (60,000 ms)
      setTimeout(() => {
        contactMessage.style.display = "none";
      }, 60000);

      // Open WhatsApp chat in new tab
      const whatsappNumber = "2348027769825"; // your number
      const whatsappText = encodeURIComponent(
        `New Logifi Message:\nName: ${data.name}\nEmail: ${data.email}\nMessage: ${data.message}`
      );
      window.open(`https://wa.me/${whatsappNumber}?text=${whatsappText}`, "_blank");

    } else {
      alert(result.message);
    }
  } catch (err) {
    console.error("Front-end error:", err);
    alert("Something went wrong. Please try again.");
  }
}); 
//   /listing lodge section////
  document.addEventListener("DOMContentLoaded", function () {
    const lodgeCards = document.querySelectorAll(".unique-lodge-card");
    lodgeCards.forEach((card, index) => {
      if (index >= 4) {
        card.remove(); // Hide extras beyond 4
      }
    });
  });

function trackClick(action, lodgeId = null, url = null) {
  fetch("/track/click", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ action, lodgeId }),
  })
  .catch(err => console.error("Tracking failed:", err))
  .finally(() => {
    if (url) {
      window.location.href = url;  // ‚úÖ use href for internal pages
      // OR window.open(url, "_blank"); // for external links
    }
  });
}


</script>


</body>
</script>
